// Test that lambdas can access global variables
#include <assert.h>

int counter = 0;

int main() {
    List<int> nums = [1, 2, 3, 4, 5];

    // Lambda accessing global variable
    nums.forEach(void function(int x) { counter += x; });
    assert(counter == 15);

    // Lambda accessing global in filter
    counter = 3;
    List<int> filtered = nums.filter(bool function(int x) { return x > counter; });
    assert(filtered.len == 2);
    assert(filtered.get(0) == 4);
    assert(filtered.get(1) == 5);

    delete filtered;
    delete nums;

    printf("PASS: test_lambda_globals\n");
    return 0;
}
